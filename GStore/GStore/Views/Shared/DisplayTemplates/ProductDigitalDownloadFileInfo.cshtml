@model Tuple<string, int>
@{
	string fileName = Model.Item1;
	int productId = Model.Item2;
}
@if (string.IsNullOrEmpty(fileName))
{
	@:(none)
}
else
{
	StoreFront storeFront = Html.CurrentStoreFront(true);
	string url = Url.Action("PreviewDigitalDownload", "ProductAdmin", new { area="CatalogAdmin", id = productId } );
	string path = storeFront.ProductDigitalDownloadFilePath(Request.ApplicationPath, ViewContext.RouteData, Server, fileName);
	if (path == null)
	{
		<h3 class="text-danger">File not found '@(url)'</h3>
	}
	else if (System.IO.File.Exists(path))
	{
		FileInfo fileInfo = new System.IO.FileInfo(path);
		<span class="text-success">File OK. Type: @(path.FileExtension()) Size: @(fileInfo.Length.ToByteString()) updated @(fileInfo.LastWriteTimeUtc) UTC</span>
	}
	else
	{
		<h3 class="text-danger">File not found '@(url)'</h3>
	}
	<br />
	<a href="@(url)" title="View full size" target="_blank">
		@(url)
		<br />
		@if (fileName.FileExtensionIsImage())
		{
			<img src="@(url)" width="80" height="80" alt="@(url)" title="@(url)" />
			<br />
			@:(view full size in a new window)
		}
		else if (fileName.FileExtensionIsAudio())
		{
			string audioType = "audio/mpeg";
			<audio controls="controls" title="@(Model)" preload="metadata">
				@if (fileName.FileExtensionIs("wav"))
				{
					audioType = "audio/wav";
				}
				else if (fileName.FileExtensionIs("ogg"))
				{
					audioType = "audio/ogg";
				}
				<source title="Sample" src="@Html.Raw(url)" type="@(audioType)" />
			</audio>
		}
		else
		{
			@:(view in a new window)
		}
	</a>
}
