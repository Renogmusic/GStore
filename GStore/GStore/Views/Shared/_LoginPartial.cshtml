@model GStore.Models.ViewModels.MenuViewModel
@if (Request.IsAuthenticated)
{
	
	using (Html.BeginForm("LogOff", "Account", FormMethod.Post, new { id = "logoutForm", @class = "navbar-right" }))
	{
		@Html.AntiForgeryToken()

	<ul class="nav navbar-nav navbar-right">
		@{
			if (Model.ShowCart)
			{
				<li>
					@{
				if (Model.Cart.IsEmpty())
				{
					<a href="@Url.Action("Index", "Cart")" title="Shopping Cart (empty)">
						Cart (empty)
					</a>
				}
				else
				{
					<a href="@Url.Action("Index", "Cart")" title="Shopping Cart - @(Model.Cart.ItemCount.ToString("N0")) item@(Model.Cart.ItemCount == 1 ? "" : "s")">
						<small>
							Cart @(Model.Cart.ItemCount.ToString("N0")) item@(Model.Cart.ItemCount == 1 ? "" : "s")
							<br />
							$@(Model.Cart.Subtotal.ToString("N2"))
						</small>
					</a>
				}
					}
				</li>
			}
			if (Model.StoreFrontConfig == null || !Model.StoreFrontConfig.IsActiveDirect())
			{
				<li><a href="#"><strong class="text-danger">INACTIVE STORE</strong></a></li>
			}
		}

		<li>
			<a href="@Url.Action("Index", "Profile")" title="My Account">
				<small>(@(Html.CurrentUserProfile(false) == null ? User.Identity.Name.ToLower() : Html.CurrentUserProfile(true).Email.ToLower()))</small>
			</a>
		</li>
		@if (Model.ShowStoreAdminLink)
		{
			//if user has store admin permissions, show store admin link
			<li>
				@Html.ActionLink("Store Admin", "Index", "StoreAdmin", new { Area = "StoreAdmin" }, htmlAttributes: new { title = "Store Admin" })
			</li>
		}
		@if (Model.ShowSystemAdminLink)
		{
			//if user has system admin permission, show system admin link
			Client currentClient = Html.CurrentClient(false);
			int? clientId = null;
			if (currentClient != null)
			{
				clientId = currentClient.ClientId;
			}
			<li>
				@Html.ActionLink("System Admin", "Index", "SystemAdmin", new { ClientId = clientId, Area = "SystemAdmin" }, htmlAttributes: new { title = "System Admin" })
			</li>
		}
		<li><a href="javascript:document.getElementById('logoutForm').submit()">Log off&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
	</ul>
	}
}
else
{
	<ul class="nav navbar-nav navbar-right">
		@{
		if (Model.ShowCart)
		{
			<li>
				@{
					if (Model.Cart.IsEmpty())
					{
						<a href="@Url.Action("Index", "Cart")" title="Shopping Cart (empty)">
							Cart (empty)
						</a>
					}
					else
					{
						<a href="@Url.Action("Index", "Cart")" title="Shopping Cart - @(Model.Cart.ItemCount.ToString("N0")) item@(Model.Cart.ItemCount == 1 ? "" : "s")"><small>
							Cart @(Model.Cart.ItemCount.ToString("N0")) item@(Model.Cart.ItemCount == 1 ? "" : "s")
							<br/>
							$@(Model.Cart.Subtotal.ToString("N2"))
							</small>
						</a>
					}
				}
			</li>
		}
		}
		@{
			if (Model.StoreFront != null)
			{
				if (Model.StoreFrontConfig.NavBarShowRegisterLink)
				{
					string signupLinkText = Model.StoreFrontConfig.NavBarRegisterLinkText;
					if (string.IsNullOrEmpty(signupLinkText))
					{
						signupLinkText = "Sign-Up";
					}
					<li>@Html.ActionLink(signupLinkText, "Register", "Account", routeValues: null, htmlAttributes: new { id = "registerLink" })</li>	
				}
				
			}
			else
			{
				<li><a href="#"><strong class="text-danger">INACTIVE STORE</strong></a></li>
			}
		}

		<li>@Html.ActionLink("Log in", "Login", "Account", routeValues: null, htmlAttributes: new { id = "loginLink" })</li>
		&nbsp;&nbsp;&nbsp;&nbsp;
	</ul>
}
